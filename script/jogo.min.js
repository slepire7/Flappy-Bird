var Config,Storage,Game,Jogo;!function(e){e.canvas=document.querySelector("canvas"),e.contexto=e.canvas.getContext("2d"),e.frames=0,e.KeyNameStorage={lastPoint:"FlappyBird1.0Lp",bestPoint:"FlappyBird1.0bp"};const a=["localhost","127.0.0.1"].includes(window.location.hostname);e.TrilhasSonoras={HIT:()=>new Audio(`${0==a?"../Flappy-Bird/":"../"}assets/efeitos/hit.wav`),PULO:()=>new Audio(`${0==a?"../Flappy-Bird/":"../"}assets/efeitos/pulo.wav`),CAIU:()=>new Audio(`${0==a?"../Flappy-Bird/":"../"}assets/efeitos/caiu.wav`),PONTO:()=>new Audio(`${0==a?"../Flappy-Bird/":"../"}assets/efeitos/ponto.wav`)},e.sprites=new Image,e.sprites.src=`${0==a?"../Flappy-Bird/":"../"}assets/texture/sprites.png`,e.Draw=a=>{e.contexto.drawImage(e.sprites,a.spriteX,a.spriteY,a.largura,a.altura,a.x,a.y,a.largura,a.altura)},e.fazColisao=function(a,e){return a=a.y+a.altura,e.y<=a}}(Config=Config||{});class flappyBird{_engine;constructor(a){this._engine=a}frameAtual=0;spriteX=0;spriteY=0;largura=33;altura=24;x=10;y=50;gravidade=.25;velocidade=0;pulo=4;pula(){Config.TrilhasSonoras.PULO().play(),this.velocidade=-this.pulo}movimentos=[{spriteX:0,spriteY:0},{spriteX:0,spriteY:26},{spriteX:0,spriteY:52},{spriteX:0,spriteY:26}];atualizaOFrameAtual(){var a,e;Config.frames%10==0&&(a=1+this.frameAtual,e=this.movimentos.length,this.frameAtual=a%e)}desenha=()=>{this.atualizaOFrameAtual();var{spriteX:a,spriteY:e}=this.movimentos[this.frameAtual];Config.Draw({spriteX:a,spriteY:e,altura:this.altura,largura:this.largura,x:this.x,y:this.y})};atualiza=a=>{this._engine.chao&&(Config.fazColisao(this,this._engine.chao)?(Config.TrilhasSonoras.CAIU().play(),a()):(this.velocidade=this.velocidade+this.gravidade,this.y=this.y+this.velocidade))}}class Chao{spriteX;spriteY;largura;altura;x;y;constructor(){this.spriteX=0,this.spriteY=610,this.largura=224,this.altura=112,this.x=0,this.y=Config.canvas.height-112}atualiza(){var a=this.largura/2,e=this.x-1;this.x=e%a}desenha(){Config.Draw({spriteX:this.spriteX,spriteY:this.spriteY,largura:this.largura,altura:this.altura,x:this.x,y:this.y}),Config.Draw({spriteX:this.spriteX,spriteY:this.spriteY,largura:this.largura,altura:this.altura,x:this.x+this.largura,y:this.y})}}class Cano{_flappyBird;largura;altura;espaco;chao;ceu;pares;constructor(a){this.largura=52,this.altura=400,this.espaco=80,this.chao={spriteX:0,spriteY:169},this.ceu={spriteX:52,spriteY:169},this.pares=[],this._flappyBird=a}desenha(){this.pares.forEach(a=>{var e=a.y,i=a.x,t=e,r=(Config.Draw({spriteX:this.ceu.spriteX,spriteY:this.ceu.spriteY,largura:this.largura,altura:this.altura,x:i,y:t}),a.x),e=this.altura+90+e;Config.Draw({spriteX:this.chao.spriteX,spriteY:this.chao.spriteY,largura:this.largura,altura:this.altura,x:r,y:e}),a.canoCeu={x:i,y:this.altura+t},a.canoChao={x:r,y:e}})}temColisaoComOFlappyBird(a,e){var i=e.y,t=e.y+e.altura;return e.x+e.largura>=a.x&&(i<=a.canoCeu.y||t>=a.canoChao.y)}atualiza(e){Config.frames%100==0&&this.pares.push({x:Config.canvas.width,y:-150*(Math.random()+1)}),this.pares.forEach(a=>{a.x=a.x-2,this.temColisaoComOFlappyBird(a,this._flappyBird)&&(Config.TrilhasSonoras.HIT().play(),e()),a.x+this.largura<=0&&this.pares.shift()})}}class PlanoDeFundo{spriteX;spriteY;largura;altura;x;y;constructor(){this.spriteX=390,this.spriteY=0,this.largura=275,this.altura=204,this.x=0,this.y=Config.canvas.height-204}desenha(){Config.contexto.fillStyle="#70c5ce",Config.contexto.fillRect(0,0,Config.canvas.width,Config.canvas.height),Config.Draw({spriteX:this.spriteX,spriteY:this.spriteY,largura:this.largura,altura:this.altura,x:this.x,y:this.y}),Config.Draw({spriteX:this.spriteX,spriteY:this.spriteY,largura:this.largura,altura:this.altura,x:this.x+this.largura,y:this.y})}atualiza(){}}!function(a){a.Set=function(a,e){localStorage.setItem(a,JSON.stringify(e))},a.Get=function(a){return(a=localStorage.getItem(a))?JSON.parse(a):""}}(Storage=Storage||{});class Placar{pontuacao=0;desenha(){Config.contexto.font='35px "VT323"',Config.contexto.textAlign="right",Config.contexto.fillStyle="white",Config.contexto.fillText(""+this.pontuacao,Config.canvas.width-10,35),Storage.Set(Config.KeyNameStorage.lastPoint,this.pontuacao),Storage.Get(Config.KeyNameStorage.bestPoint)<Storage.Get(Config.KeyNameStorage.lastPoint)&&Storage.Set(Config.KeyNameStorage.bestPoint,this.pontuacao)}atualiza(){Config.frames%30==0&&(Config.TrilhasSonoras.PONTO().play(),this.pontuacao=this.pontuacao+1)}}class ScoreGame{constructor(){ScoreGame.none={spriteX:0,spriteY:78,largura:44,altura:44,x:Config.canvas.width/2/2.4,y:135,desenha(){Config.Draw({spriteX:ScoreGame.none.spriteX,spriteY:ScoreGame.none.spriteY,largura:ScoreGame.none.largura,altura:ScoreGame.none.altura,x:ScoreGame.none.x,y:ScoreGame.none.y})}},ScoreGame.bronze={spriteX:48,spriteY:124,largura:44,altura:44,x:Config.canvas.width/2/2.4,y:135,desenha(){Config.Draw({spriteX:ScoreGame.bronze.spriteX,spriteY:ScoreGame.bronze.spriteY,largura:ScoreGame.bronze.largura,altura:ScoreGame.bronze.altura,x:ScoreGame.bronze.x,y:ScoreGame.bronze.y})}},ScoreGame.prata={spriteX:48,spriteY:78,largura:44,altura:44,x:Config.canvas.width/2/2.4,y:135,desenha(){Config.Draw({spriteX:ScoreGame.prata.spriteX,spriteY:ScoreGame.prata.spriteY,largura:ScoreGame.prata.largura,altura:ScoreGame.prata.altura,x:ScoreGame.prata.x,y:ScoreGame.prata.y})}},ScoreGame.ouro={spriteX:0,spriteY:124,largura:44,altura:44,x:Config.canvas.width/2/2.4,y:135,desenha(){Config.Draw({spriteX:ScoreGame.ouro.spriteX,spriteY:ScoreGame.ouro.spriteY,largura:ScoreGame.ouro.largura,altura:ScoreGame.ouro.altura,x:ScoreGame.ouro.x,y:ScoreGame.ouro.y})}}}static none;static bronze;static prata;static ouro;static desenha(){var a=Storage.Get(Config.KeyNameStorage.lastPoint),e=Storage.Get(Config.KeyNameStorage.bestPoint);Config.contexto.fillText(""+a,Config.canvas.width/3*2.4,147),Config.contexto.fillText(""+e,Config.canvas.width/3*2.4,Config.canvas.width/3*1.9),a<50?ScoreGame.none.desenha():a<=100?ScoreGame.bronze.desenha():a<=150?ScoreGame.prata.desenha():200<=a&&ScoreGame.ouro.desenha()}}!function(a){{var e=a.Main||(a.Main={});function i(a){e.TelaAtiva=a,e.TelaAtiva.inicializa&&e.TelaAtiva.inicializa()}function t(a){return()=>{e.TelaAtiva=a,e.TelaAtiva.inicializa&&e.TelaAtiva.inicializa()}}e.Engine={},e.Telas={INICIO:{inicializa(){e.Engine.flappyBird=new flappyBird(e.Engine),e.Engine.chao=new Chao,e.Engine.canos=new Cano(e.Engine.flappyBird)},desenha(){(new PlanoDeFundo).desenha(),e.Engine.flappyBird.desenha(),e.Engine.chao.desenha(),r.desenha()},click(){i(e.Telas.JOGO)},atualiza(){e.Engine.chao.atualiza()}},JOGO:{inicializa(){e.Engine.placar=new Placar},desenha(){(new PlanoDeFundo).desenha(),e.Engine.canos.desenha(),e.Engine.chao.desenha(),e.Engine.flappyBird.desenha(),e.Engine.placar.desenha()},click(){e.Engine.flappyBird.pula()},atualiza(){e.Engine.canos.atualiza(t(e.Telas.GAME_OVER)),e.Engine.chao.atualiza(),e.Engine.flappyBird.atualiza(t(e.Telas.GAME_OVER)),e.Engine.placar.atualiza()}},GAME_OVER:{inicializa(){},desenha(){s.desenha&&s.desenha(),ScoreGame.desenha()},atualiza(){},click(){i(e.Telas.INICIO)}}},e.mudaParaTela=i,e.TelaCondicional=t,e.TelaAtiva={click:()=>{},atualiza:()=>{},desenha:()=>{},inicializa:()=>{}};const r={spriteX:134,spriteY:0,largura:174,altura:152,x:Config.canvas.width/2-87,y:50,desenha:()=>{Config.Draw({spriteX:r.spriteX,spriteY:r.spriteY,largura:r.largura,altura:r.altura,x:r.x,y:r.y})}},s={spriteX:134,spriteY:153,largura:226,altura:200,x:Config.canvas.width/2-113,y:50,desenha(){Config.Draw({spriteX:s.spriteX,spriteY:s.spriteY,largura:s.largura,altura:s.altura,x:s.x,y:s.y})}}}}(Game=Game||{}),function(a){function e(){Game.Main.TelaAtiva.desenha(),Game.Main.TelaAtiva.atualiza(),Config.frames=Config.frames+1,requestAnimationFrame(e)}(a.PageEvents||(a.PageEvents={})).Main=function(){document.getElementById("game-canvas").addEventListener("click",function(){Game.Main.TelaAtiva.click&&Game.Main.TelaAtiva.click()}),window.addEventListener("keypress",function(a){Game.Main.TelaAtiva.click&&Game.Main.TelaAtiva.click()}),Game.Main.mudaParaTela(Game.Main.Telas.INICIO),e()}}(Jogo=Jogo||{}),Jogo.PageEvents.Main();